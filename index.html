<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Catatan Pembelian</title>

<style>
*{box-sizing:border-box;}
body {
  font-family: 'Segoe UI', sans-serif;
  margin: 0; padding: 20px; background: #f2f7ff;
}
.container {
  max-width: 480px; margin: auto; background: #fff; padding: 20px;
  border-radius: 10px; box-shadow: 0 3px 10px rgba(0,0,0,0.1);
}
h2 { text-align:center; margin-top:0; }

.form-group { margin-bottom:12px; }
label { font-size:14px; font-weight:600; display:block; margin-bottom:5px; }
input, select {
  width:100%; padding:10px; border:1px solid #ccc;
  border-radius:6px; font-size:15px;
}
button {
  width:100%; padding:12px; font-size:16px;
  background:#007bff; border:none; border-radius:8px; color:#fff;
  cursor:pointer; font-weight:600; margin-bottom:8px;
}
button:hover { background:#0069d9; }
#toggleBtn { background:#28a745; }
#toggleBtn:hover { background:#218838; }

/* POPUP */
.modal {
  display:none; position:fixed; top:0; left:0;
  width:100%; height:100%; background:rgba(0,0,0,0.5);
  justify-content:center; align-items:center;
}
.modal-content {
  background:#fff; padding:20px; width:90%; max-width:650px;
  border-radius:10px; position:relative;
  max-height:85vh; overflow-y:auto;
}
.close {
  position:absolute; right:12px; top:8px;
  font-size:22px; font-weight:bold; cursor:pointer;
}
table { width:100%; border-collapse:collapse; margin-top:10px; }
th, td {
  border:1px solid #ddd; padding:10px; text-align:center;
  font-size:14px;
}
th { background:#007bff; color:white; }

/* tombol hapus */
.delete-btn {
  background:#dc3545; border:none; color:white; padding:6px 10px;
  border-radius:5px; cursor:pointer;
}
.delete-btn:hover { background:#b02a37; }

.total-box {
  margin-top:10px; font-size:16px; font-weight:bold; text-align:right;
}
</style>

</head>
<body>

<div class="container">
  <h2>Catatan Pembelian</h2>

  <div class="form-group">
    <label>Pembelian</label>
    <input type="text" id="description" placeholder="Contoh: Beras" required>
  </div>

  <div style="display:flex; gap:10px;">
    <div class="form-group" style="flex:1;">
      <label>Jumlah</label>
      <input type="number" id="quantity" placeholder="0" min="1" value="1">
    </div>

    <div class="form-group" style="flex:1;">
      <label>Satuan</label>
      <select id="unit">
        <option value="pcs">pcs</option>
        <option value="kg">kg</option>
        <option value="liter">liter</option>
        <option value="pack">pack</option>
        <option value="box">box</option>
        <option value="unit">unit</option>
      </select>
    </div>
  </div>

  <div class="form-group">
    <label>Harga per Unit (Rp)</label>
    <input type="number" id="pricePerUnit" placeholder="Contoh: 5000" min="0">
  </div>

  <div class="form-group">
    <label>Nominal Total (Rp)</label>
    <input type="number" id="amount" placeholder="0" min="0">
  </div>

  <div class="form-group">
    <label>Tanggal</label>
    <input type="date" id="date">
  </div>

  <button id="saveBtn">Simpan</button>
  <button id="toggleBtn">Tampilkan Data</button>
</div>

<!-- POPUP MODAL -->
<div id="modal" class="modal">
  <div class="modal-content">
    <span class="close" onclick="closeModal()">&times;</span>
    <h3 style="text-align:center;margin:0;">Data Pembelian</h3>
    <table>
      <thead>
        <tr>
          <th>Pembelian</th>
          <th>Jumlah</th>
          <th>Satuan</th>
          <th>Nominal (Rp)</th>
          <th>Tanggal</th>
          <th>Aksi</th>
        </tr>
      </thead>
      <tbody id="tableBody"></tbody>
    </table>

    <div class="total-box">
      Total: Rp <span id="totalBelanja">0</span>
    </div>
  </div>
</div>

<script>
let data = JSON.parse(localStorage.getItem("pembelian") || "[]");

document.getElementById("pricePerUnit").addEventListener("input", autoHitung)
document.getElementById("quantity").addEventListener("input", autoHitung)

function autoHitung(){
  const qty = parseFloat(quantity.value)||0;
  const price = parseFloat(pricePerUnit.value)||0;
  amount.value = qty * price;
}

document.getElementById("saveBtn").onclick = function(){
  const item = {
    id: Date.now(),
    description: description.value.trim(),
    quantity: parseFloat(quantity.value),
    unit: unit.value,
    pricePerUnit: parseFloat(pricePerUnit.value),
    amount: parseFloat(amount.value),
    date: date.value || new Date().toISOString().split("T")[0]
  };

  if (!item.description || !item.quantity || !item.amount){
    alert("Silakan isi semua data");
    return;
  }

  data.push(item);
  localStorage.setItem("pembelian", JSON.stringify(data));
  resetForm();
};

document.getElementById("toggleBtn").onclick = function(){
  showData();
  document.getElementById("modal").style.display = "flex";
};

function showData(){
  const tbody = document.getElementById("tableBody");
  tbody.innerHTML = "";
  let total = 0;

  data.forEach(item => {
    total += item.amount;

    tbody.innerHTML += `
      <tr>
        <td>${item.description}</td>
        <td>${item.quantity}</td>
        <td>${item.unit}</td>
        <td>Rp ${item.amount.toLocaleString()}</td>
        <td>${item.date}</td>
        <td><button class="delete-btn" onclick="hapus(${item.id})">Hapus</button></td>
      </tr>
    `;
  });

  document.getElementById("totalBelanja").textContent = total.toLocaleString();
}

function hapus(id){
  if(confirm("Hapus data ini?")){
    data = data.filter(item => item.id !== id);
    localStorage.setItem("pembelian", JSON.stringify(data));
    showData(); 
  }
}

function closeModal(){ document.getElementById("modal").style.display = "none"; }

function resetForm(){
  description.value="";
  quantity.value=1;
  pricePerUnit.value="";
  amount.value="";
  date.value="";
  unit.value="pcs";
}
</script>

</body>
  </html>
  
